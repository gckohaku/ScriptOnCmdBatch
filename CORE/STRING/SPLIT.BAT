SET OBJ_COUNT=0
SET STR_INDEX=0
SET STR=%~1
CALL SET %~3.0=

CALL SUB/STRLEN.BAT %1
SET STR_LEN=%ERRORLEVEL%

:LBL_LOOP_TOP

CALL SET CHAR=%%STR:~%STR_INDEX%,1%%

IF "%CHAR%" EQU %2 (
	SET /A OBJ_COUNT=%OBJ_COUNT% + 1
	GOTO LBL_CHECK_INDEX
)

CALL SET %~3.%OBJ_COUNT%=%%%~3.%OBJ_COUNT%%%%%STR:~%STR_INDEX%,1%%

:LBL_CHECK_INDEX

SET /A STR_INDEX=%STR_INDEX% + 1

IF %STR_INDEX% EQU %STR_LEN% (
	GOTO LBL_LOOP_END
)

GOTO LBL_LOOP_TOP

:LBL_LOOP_END

SET /A OBJ_COUNT=%OBJ_COUNT% + 1

EXIT /B %OBJ_COUNT%